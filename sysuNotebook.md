# (Note)Learning Semantic-Specific Graph Representation for Multi-Label Image Recognition
  
## è®ºæ–‡é˜…è¯»è®°å½•

åŸæ–‡ï¼š
https://arxiv.org/pdf/1908.07325.pdf

ç›®å‰è¿˜ä¸æ¸…æ¥šå†…æ¶µçš„å…³é”®è¯ï¼š
1. multi-label recognition
2. semantic-aware
3. decoupling
4. å›¾è¡¨ç¤ºå­¦ä¹ 

å…ˆææ¸…æ¥šè¿™äº›åŸºæœ¬æ¦‚å¿µå§ã€‚
##### å¤šæ ‡ç­¾åˆ†ç±»
æ‰¾åˆ°ä¸€ç¯‡ç»¼è¿°ï¼š
https://www.cnblogs.com/cxf-zzj/p/10049613.html

å¤šæ ‡ç­¾çš„éœ€æ±‚ï¼šä»¥æ–‡ç« åˆ†ç±»ä¸¾ä¾‹ï¼Œä¸€ç¯‡æ–‡ç« æ—¢å¯ä»¥å±äºâ€œç»æµâ€ä¹Ÿå¯ä»¥å±äºâ€œæ–‡åŒ–â€ã€‚
éš¾ç‚¹ï¼š
- ä¸€ä¸ªentity(ä¸çŸ¥é“å¯ä¸å¯ä»¥ç”¨è¿™ä¸ªå•è¯å½¢å®¹)å¯¹åº”çš„ç±»æ ‡æ•°é‡ç›¸å·®å·¨å¤§ï¼Œå¯èƒ½å¯¹åº”1ä¸ªä¹Ÿå¯èƒ½å¯¹åº”å‡ ç™¾ä¸ª
- ç±»æ ‡ä¹‹é—´çš„ç›¸äº’ä¾èµ–/è€¦åˆï¼Ÿ
- éš¾ä»¥è·å–è®­ç»ƒé›†ï¼Œè€ç”Ÿå¸¸è°ˆäº†

è§£å†³æ–¹æ³•ï¼šä¸¤å¤§ç±»(çœ‹èµ·æ¥æ²¡æœ‰å•¥ç‰¹åˆ«é’ˆå¯¹çš„ç®—æ³•ï¼Ÿ)
1. åŸºäºé—®é¢˜è½¬åŒ–çš„æ–¹æ³•
   1. æœ€ç®€å•çš„ï¼šå•æ ‡ç­¾é¢„æµ‹
   2. è¦è€ƒè™‘å…³è”æ€§çš„è¯ï¼Œç”¨åˆ†ç±»å™¨é“¾æˆ–è€…æ—¶åº(å‰ä¸€ä¸ªçš„outæ˜¯åä¸€ä¸ªçš„in)
   3. æˆ–è€…æ ‡ç­¾ç»„åˆ(ä½†æ˜¯æ ¹æœ¬æ²¡æ³•ç”¨åœ¨æ ‡ç­¾ç»´åº¦é«˜çš„æƒ…å†µä¸‹)
2. åŸºäºç®—æ³•é€‚ç”¨çš„æ–¹æ³•
   1. ä¸»è¦æ˜¯æ”¹é€ ç®—æ³•ï¼Œä¼¼ä¹åœ¨æ·±åº¦å­¦ä¹ é¢†åŸŸä¼šç”¨åˆ°æ³¨æ„åŠ›æœºåˆ¶ï¼Œè®ºæ–‡ä¸­çš„semantic-awareåº”è¯¥ä¹Ÿæ˜¯å·®ä¸å¤šçš„æ„æ€

##### semantic-aware
åº”è¯¥æ˜¯ç”¨åˆ°äº†è¯­ä¹‰çš„è¿™ç§â€œæ³¨æ„åŠ›â€çš„æœºåˆ¶ï¼Œæ¥ç€çœ‹ä¸‹å»åº”è¯¥å°±æ¸…æ¥šäº†
##### decoupling
å°±æ˜¯è§£è€¦å§
##### å›¾è¡¨ç¤ºå­¦ä¹ 
ä¹‹å‰ä¸€ç›´æ²¡è®¤çœŸäº†è§£è¿‡å›¾è¿™æ–¹é¢çš„ç»“æ„

å‚è€ƒï¼š
https://zhuanlan.zhihu.com/p/85677181

å›¾å­¦ä¹ çš„ä½œç”¨ï¼š
èŠ‚ç‚¹åˆ†ç±»ï¼Œé“¾æ¥é¢„æµ‹ï¼Œç¤¾ç¾¤æ£€æµ‹ï¼Œç½‘ç»œç›¸ä¼¼åº¦
- Embedding: ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾å‘é‡ï¼Œä¸ç®¡å®ƒæ˜¯å¦æ¥è‡ªä¸€ä¸ªè®­ç»ƒçš„ç½‘ç»œï¼Œæˆ–æ˜¯æ¥è‡ªå…¶ä»–æ–¹æ³•çš„æ„é€ ï¼Œæˆ‘ä»¬éƒ½å¯ç§°ä¹‹ä¸ºEmbeddingã€‚å› ä¸ºæˆ‘ä»¬çš„æœ€ç»ˆç›®æ ‡æ˜¯è¿­ä»£å‡ºæœ€ä¼˜çš„ç‰¹å¾å‘é‡ï¼Œè•´å«ç›¸ä¼¼åº¦ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠè¿™ç§ç‰¹å¾å‘é‡ä¹Ÿç§°ä¹‹ä¸ºEmbedding.
éš¾ç‚¹åœ¨äºæŠ½å–å›¾ç»“æ„æ•°æ®çš„ç‰¹å¾ã€‚
æ‰€ä»¥è¯´æ‰€è°“å›¾å­¦ä¹ çš„å…³é”®ä¼¼ä¹åœ¨äºå¦‚ä½•é«˜æ•ˆåœ°å°†è¾“å…¥æ•°æ®(å³å›¾ç»“æ„ï¼Œnodes)æ˜ å°„åˆ°ç‰¹å¾å‘é‡ï¼Œå¹¶åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ä¿ç•™å°½å¯èƒ½ä¸°å¯Œçš„æ‹“æ‰‘ä¿¡æ¯(æ‰€ä»¥å«"è¡¨ç¤ºå­¦ä¹ "?)
- å›¾è¡¨ç¤ºå­¦ä¹ çš„ç›®æ ‡å°±æ˜¯ç”¨nä¸ªå‘é‡è¡¨ç¤ºå›¾ä¸Šçš„nä¸ªç»“ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥å°†ä¸€ä¸ªéš¾ä»¥è¡¨è¾¾çš„æ‹“æ‰‘ç»“æ„è½¬åŒ–ä¸ºå¯ä»¥ä¸¢è¿›ç‚¼ä¸¹ç‚‰çš„ vectorï¼
1. å›¾ç»“æ„è¡¨ç¤ºå­¦ä¹ 
   - Node2vecï¼šå•ä¸ªèŠ‚ç‚¹åˆ°é‚»å±…èŠ‚ç‚¹è·³è·ƒçš„æ¦‚ç‡æ˜¯ä¸åŒçš„(æœ‰ç‚¹åƒå¼ºåŒ–å­¦ä¹ çš„é©¬å°”ç§‘å¤«é“¾ï¼Ÿ)
   BFS: å®½åº¦ä¼˜å…ˆï¼›DFS: æ·±åº¦ä¼˜å…ˆ

2. å›¾ç‰¹å¾è¡¨ç¤ºå­¦ä¹ 
   - GCNï¼šâ€œç»“ç‚¹iåœ¨ä¸‹ä¸€å±‚çš„è¡¨ç¤ºæ˜¯ç”±å…¶æ‰€æœ‰é‚»å±…èŠ‚ç‚¹jæ‰€æ„æˆçš„é›†åˆNeighbor(i)æ¥å†³å®šçš„â€ï¼Œé‚»å±…ç»“ç‚¹çš„èšåˆã€‚
   - GraphSAGEï¼šåªé€‰æ‹©Sä¸ªé‚»å±…èŠ‚ç‚¹è¿›è¡Œèšåˆï¼Œæœ‰ç‚¹åƒdropoutï¼Œå¢åŠ å¯è®¡ç®—æ€§
   - GATï¼šåŠ äº†æ³¨æ„åŠ›æœºåˆ¶ã€‚(ps:è®ºæ–‡å…¬å¼ä¸­çš„||æ˜¯concatæ“ä½œ)

è®ºæ–‡ä¸­æ–‡è¯‘æ–‡å‚è€ƒï¼šhttps://blog.csdn.net/weixin_43436958/article/details/111564594
#### Abstractï¼š 
[Q1]
è¯­ä¹‰è§£è€¦æ¨¡å—å’Œè¯­ä¹‰äº¤äº’æ¨¡å—ï¼Ÿä¸€ä¸ªå®ä½“æ‰€å¯¹åº”çš„æ ‡ç­¾ä¹‹é—´æ˜¯å¯èƒ½å…·æœ‰æ½œåœ¨è”ç³»çš„ã€‚æŒ–æ˜æ ‡ç­¾çš„è¿™ç§è¯­ä¹‰ä¿¡æ¯å¯èƒ½ä¼šå¯¹æé«˜åˆ†ç±»ç²¾åº¦æœ‰ç›Šï¼Œä½†æ˜¯å¬èµ·æ¥æœ‰ç‚¹ç„ä¹

[A1]
**çœ‹äº†åé¢çš„è®ºæ–‡ï¼Œå¤§æ¦‚æ‡‚è®­ç»ƒçš„æµç¨‹äº†ã€‚å®é™…ä¸Šæ‰€è°“çš„è¯­ä¹‰è§£è€¦å°±æ˜¯å°†ç±»åˆ«è¯ç”¨Gloveæ¨¡å‹æ‰©å……åˆ°è•´å«æ›´å¤šä¸Šä¸‹æ–‡ä¿¡æ¯çš„è¯å‘é‡ï¼Œå†ç”¨è¿™ä¸ªä½ç§©åŒçº¿æ€§æ± åŒ–æ¥èåˆå›¾åƒç‰¹å¾å’Œè¯å‘é‡æœ€ååŠ æƒï¼Œç±»ä¼¼äºæŒ‰ç…§ä¸åŒæƒé‡åŒæ—¶å­¦ä¹ å¤šä¸ªç±»åˆ«æ ‡ç­¾**
#### Introductionï¼š
**æˆ‘ä»¬é¦–å…ˆè®¾è®¡ä¸€ä¸ªè¯­ä¹‰è§£è€¦æ¨¡å—ï¼Œè¯¥æ¨¡å—åˆ©ç”¨ç±»åˆ«çš„è¯­ä¹‰ç‰¹å¾æ¥æŒ‡å¯¼å­¦ä¹ ä¸ç±»åˆ«ç›¸å…³çš„å›¾åƒç‰¹å¾ï¼Œè¿™äº›å›¾åƒç‰¹å¾æ›´åŠ å…³æ³¨ç›¸åº”çš„è¯­ä¹‰åŒºåŸŸã€‚ç„¶åï¼Œæˆ‘ä»¬æ„å»ºä¸€ä¸ªåŸºäºç»Ÿè®¡æ ‡ç­¾å…±ç°çš„å›¾æ¥å…³è”è¿™äº›ç‰¹å¾ï¼Œå¹¶é€šè¿‡å›¾ä¼ æ’­æœºåˆ¶æ¥æ¢ç´¢å®ƒä»¬ä¹‹é—´çš„ç›¸äº’ä½œç”¨**

#### Related Worksï¼š
æç‚¼ä¸€ä¸‹ï¼šæœ€è¿‘å¤šæ ‡ç­¾åˆ†ç±»çš„è¿›å±•å¤šåœ¨äºå¼•å…¥äº†å¯¹è±¡å®šä½ï¼Œäº§ç”Ÿå€™é€‰åŒºåŸŸproposal(ç±»æ¯”Faster-RCNN)ï¼Œä½¿å¾—å®ƒå¯ä»¥æ³¨æ„åˆ°å›¾åƒçš„å„ä¸ªå­åŒºåŸŸï¼Œåˆ†åˆ«è¿›è¡Œé¢„æµ‹ï¼Œä½†æ˜¯å€™é€‰åŒºåŸŸçš„äº§ç”Ÿå’Œç­›é€‰éš¾ä»¥è¢«ç«¯åˆ°ç«¯è®­ç»ƒ

[Q1]
æ„Ÿè§‰å’ŒFaster-RCNNè¿™äº›ç›®æ ‡æ£€æµ‹æå…¶ç›¸ä¼¼ã€‚ã€‚ã€‚é‚£è¿™ä¹ˆè¯´ï¼Œå¤šæ ‡ç­¾å›¾åƒåˆ†ç±»å®Œå…¨æ²¡å¿…è¦å•Šï¼Œå› ä¸ºå®ƒå®Œå…¨å¯ä»¥ç”¨ç›®æ ‡æ£€æµ‹æ¨¡å‹æ¥åšä¸æ˜¯å—???é‚£ä¸ºå•¥è¦æå¾—è¿™ä¹ˆéº»çƒ¦.....

[A1]**æ‡‚äº†ï¼Œè¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚å›¾åƒåˆ†ç±»æ¯•ç«Ÿæ˜¯åˆ†ç±»ï¼Œæ•°æ®é›†ä¸­æ ‡ç­¾åªéœ€è¦ç»™å‡ºå›¾åƒå¯¹åº”çš„ç±»åˆ«å°±è¡Œï¼Œè€Œä¸éœ€è¦åƒç›®æ ‡æ£€æµ‹ä¸€æ ·ç»™å‡ºBBoxæ ‡å®šã€‚ç›®æ ‡æ£€æµ‹ç¡®å®æ˜¯å¤šæ ‡ç­¾å›¾åƒåˆ†ç±»çš„ä¸Šä½ï¼Œä½†æ˜¯ä»–è¦çš„è®­ç»ƒé›†æˆæœ¬ä¹Ÿé«˜å¾—å¤šï¼Œå› æ­¤ï¼Œè®¾è®¡ä¸€ä¸ªåªéœ€è¦å¸¸è§„çš„å›¾åƒåˆ†ç±»æ•°æ®é›†å´èƒ½å¤Ÿæ¥è¿‘ç›®æ ‡æ£€æµ‹é‚£æ ·å¤šç±»æ£€æµ‹çš„æ•ˆæœçš„æ¨¡å‹ï¼Œè¿˜æ˜¯å¾ˆæœ‰æ„ä¹‰çš„**

ä¹Ÿæœ‰ç”¨æ³¨æ„åŠ›æœºåˆ¶æ¥å®šä½åŒºåŸŸçš„ï¼Œä½†æ˜¯å®šä½ä¸ç²¾ç¡®.

æˆ–è€…ä¹Ÿå¯ä»¥åˆ©ç”¨æ ‡ç­¾çš„ä¾èµ–å…³ç³»æ¥å»ºæ¨¡(åº”è¯¥å’Œä½œè€…çš„æ–¹æ³•å±äºåŒä¸€ç±»çš„)ï¼ŒLSTMå’ŒRNNè¿™ç§å…·æœ‰åºåˆ—å…³ç³»é¢„æµ‹åŠŸèƒ½çš„ç½‘ç»œå°±å¯ä»¥åŠåˆ°ï¼Œä½†æ˜¯å¹¶ä¸èƒ½å®Œå…¨åˆ©ç”¨è¯¥ç‰¹æ€§(å¯èƒ½æ˜¯å› ä¸ºä»–ä»¬åªèƒ½æŒ‰ç…§æ—¶åº?)

#### SSGRL Framework:
1. Overview

   å…³é”®ï¼š1ã€å¯¹äºæ¯ä¸ªç±»åˆ«ï¼Œè¯­ä¹‰è§£è€¦æ¨¡å—ç»“åˆç±»åˆ«è¯­ä¹‰æ¥æŒ‡å¯¼å­¦ä¹ ç‰¹å®šäºè¯­ä¹‰çš„è¡¨ç¤º
   2ã€è¯­ä¹‰äº¤äº’æ¨¡å—ä½¿ç”¨åŸºäºç»Ÿè®¡æ ‡ç­¾å…±ç°æ„å»ºçš„å›¾æ¥å…³è”è¿™äº›è¡¨ç¤ºã€‚

2. Semantic Decoupling:

   [Q1]
   è¿™ä¸€éƒ¨åˆ†çš„ï¼š
   >For each category c, the framework extracts a ds-dimensional semantic-embedding vector using the pre-trained GloVe model

   è¿™ä¸ªdç»´è¯­ä¹‰embedding vectoræ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿä¸èƒ½ç†è§£è¿™é‡Œçš„fgæ˜¯æŒ‡ä»£ä»€ä¹ˆã€‚wcæ˜¯æ‰€è°“â€œcç±»åˆ«å¯¹åº”çš„semantic wordâ€ï¼Œè¿™é‡Œä¹Ÿæ²¡ææ¸…æ¥š

   [A1]
   **ç¨å¾®æ‡‚ä¸€ç‚¹äº†ã€‚è¿™é‡Œæ˜¯å•ç‹¬å¤„ç†ç±»åˆ«å¯¹åº”çš„è¯ï¼Œç”¨Gloveæ¨¡å‹è®­ç»ƒå‡ºæ¥ä¸€ä¸ªå¯¹åº”çš„è¯­ä¹‰å‘é‡ï¼Œèµ‹äºˆå…¶è¯­ä¹‰ä¿¡æ¯ã€‚æ¯”å¦‚è¯´è¾“å…¥carï¼Œè¿”å›å®ƒçš„å‘é‡ï¼Œè€Œè¿™ä¸ªå‘é‡åˆå’Œtrack,bus,trainç­‰ç±»ä¼¼ã€‚ç­‰äºè¯´èµ‹äºˆæ ‡ç­¾ä»¥è¯­ä¹‰ä¿¡æ¯ã€‚**

   æ¦‚æ‹¬ï¼šè¿™ä¸€æ­¥æå–äº†1ã€å›¾åƒçš„ç‰¹å¾ï¼›2ã€è¯¥å›¾åƒå¯¹åº”ç±»åˆ«çš„è¯åµŒå…¥å‘é‡  ç„¶åç”¨ä½ç§©åŒçº¿æ€§æ± åŒ–å°†ä»–ä»¬èåˆï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå…¨è¿æ¥ç½‘ç»œè®¡ç®—ä»–ä»¬çš„æ³¨æ„ç³»æ•°ã€‚æœ€åå¯¹è¿™äº›æ³¨æ„ç³»æ•°è¿›è¡Œå½’ä¸€åŒ–ï¼Œå¹¶ä¸ä¸Šé¢çš„èåˆåçš„ç‰¹å¾æ±‚åŠ æƒå¹³å‡ã€‚

   [Q2]
   ä½ç§©åŒçº¿æ€§æ± åŒ–?

   [A2]
   https://zhuanlan.zhihu.com/p/62532887

   æ˜¯ä¸€ç§ç‰¹å¾èåˆçš„æ‰‹æ®µ
   åŸå§‹çš„Bilinear Poolingå­˜åœ¨èåˆåçš„ç‰¹å¾ç»´æ•°è¿‡é«˜çš„é—®é¢˜ï¼Œèåˆåçš„ç‰¹å¾ç»´æ•°=ç‰¹å¾xå’Œç‰¹å¾yçš„ç»´æ•°ä¹‹ç§¯ã€‚
   æ”¹è¿›ï¼šLRBPï¼šLow-rank Bilinear Pooling
   æ€ä¹ˆè¯´ï¼Œæœ‰ç‚¹åƒæ˜¯æ±‚ä¸¤ä¸ªç‰¹å¾çš„gram matrix, which is used in neural style transfer.


3. Semantic Interaction

   å¼•å…¥å›¾Gï¼Œå…¶ä¸­èŠ‚ç‚¹æŒ‡çš„æ˜¯ç±»åˆ«ï¼Œè¾¹æŒ‡çš„æ˜¯å¯¹åº”ç±»åˆ«ä¹‹é—´çš„å…±ç°æ¦‚ç‡ã€‚
   æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥èšé›†æ¥è‡ªå…¶ä»–èŠ‚ç‚¹çš„æ¶ˆæ¯ï¼Œå¹¶åŒæ—¶é€šè¿‡å›¾ä¼ é€’å…¶ä¿¡æ¯ï¼Œä»è€Œèƒ½å¤Ÿåœ¨å¯¹åº”äºæ‰€æœ‰ç±»åˆ«çš„æ‰€æœ‰ç‰¹å¾å‘é‡ä¹‹é—´è¿›è¡Œäº¤äº’,è¯¥è¿‡ç¨‹é‡å¤Tæ¬¡ï¼Œç”Ÿæˆæœ€ç»ˆçš„éšè—çŠ¶æ€ã€‚è¿™æ ·å°±å¯ä»¥å­¦ä¹ ä¸€ä¸ªå„ç±»åˆ«ä¹‹é—´ç›¸å…³ä¿¡æ¯çš„éšè—è¡¨ç¤ºäº†
   è®ºæ–‡åœ¨è¿™é‡Œå°†å›¾ç»“æ„å†™ä½œ{V,A}ï¼ŒVè¡¨ç¤ºä¸åŒçš„ç±»åˆ«è¯{v0,v1,v2â€¦,v(c-1)}ï¼ŒAè¡¨ç¤ºåœ¨cç±»åˆ«å­˜åœ¨çš„æ¡ä»¶ä¸‹ï¼Œcâ€™ç±»åˆ«å­˜åœ¨çš„æ¦‚ç‡ï¼ŒAè¡¨ç¤ºä¸º{a00,a01,a02â€¦,a0(c-1),â€¦a(c-1)(c-1)}ã€‚

   https://blog.csdn.net/qq_45603919/article/details/109126254

   ğŸ‘†è¿™ç¯‡æ–‡ç« åœ¨å›¾ç½‘ç»œè¿™éƒ¨åˆ†è®²çš„å¾ˆè¯¦ç»†ï¼Œçœä¸‹ä¸å°‘æ—¶é—´ã€‚

   éšè—çŠ¶æ€ï¼šå°†æŸä¸ªç»“ç‚¹å‘¨å›´çš„ä¿¡æ¯èåˆæˆä¸€ä¸ªå‘é‡è¡¨ç¤ºï¼Œå› æ­¤å¯ä»¥ç”¨ä¸Šä¸€æ­¥ç”Ÿæˆçš„ç‰¹å¾å‘é‡æ¥åˆå§‹åŒ–è¿™ä¸ªéšè—çŠ¶æ€ã€‚
   ç‰¹å¾èšåˆå‘é‡ï¼šæŸä¸ªç±»åˆ«å¯¹åº”çš„éšè—çŠ¶æ€å’Œä¸¤ä¸ªå…±ç°æ¦‚ç‡çš„åŠ æƒå’Œã€‚





4. Network Structure
   fcnnæ˜¯ResNet-101,æ”¹äº†æœ€åä¸€ä¸ªå¹³å‡æ± åŒ–å±‚

5. Optimization

## ä»£ç å¤ç°è®°å½•

#### 15ï¼š30ï¼Œ8/1
å¼€å§‹å¹²æ´»

__ç›®æ ‡æ˜¯ï¼šæ­å»ºè®ºæ–‡ä¸­çš„ResNet-101 å¤šæ ‡ç­¾åˆ†ç±»baselineï¼Œå¹¶åœ¨COCOæ•°æ®é›†ä¸Šè®­ç»ƒè°ƒå‚ï¼Œä½¿å…¶èƒ½è¾¾åˆ°çº¦80.3çš„mAPã€‚__

ç½‘ç»œç»“æ„çš„æè¿°ï¼š
> Specifically, we simply replace the last fully connected layer of the ResNet-101 with a 2,048-to-C fully connected layer and use C sigmoid functions to predict the probability of each category

å»æ‰æœ€åä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œæ¢æˆä¸€ä¸ª2048-to-Cçš„å…¨è¿æ¥å±‚ï¼Œç„¶åä½¿ç”¨C sigmoidå‡½æ•°å»é¢„æµ‹æ¯ä¸€ç±»çš„æ¦‚ç‡ã€‚

è®­ç»ƒå’Œæµ‹è¯•è®¾å®šï¼š

æŸå¤±å‡½æ•°ç”¨äº¤å‰ç†µ

ä½œè€…ä½¿ç”¨çš„imageneté¢„è®­ç»ƒçš„ResNet-101æ¨¡å‹

Adamä¼˜åŒ–å™¨ï¼Œbatchsize = 4ï¼ŒåŠ¨é‡ä¸º0.99å’Œ0.9

åˆå§‹å­¦ä¹ ç‡ï¼š10^-5,è¯¯å·®è¶‹äºå¹³ç¨³æ—¶ï¼Œå†é™¤ä»¥10.

input:640x640ï¼Œ {640, 576, 512, 384, 320}éšæœºè£åˆ‡patchesï¼Œæœ€åè¿™äº›patcheså†resizeåˆ°576x576.
å¯¹äºtestingï¼Œç›´æ¥å…ˆresize to 640x640å†ä¸­å¿ƒè£åˆ‡576x576

metricsï¼šmean average precisionã€‚

æ¯å¼ å›¾å–å¾—åˆ†æœ€é«˜çš„ä¸‰ä¸ªæ ‡ç­¾ï¼Œå¹¶å’Œå®é™…å€¼æ¯”å¯¹ã€‚

å¯¹äºCOCOæ•°æ®é›†ï¼Œå†è®­ç»ƒé›†ä¸Šè®­ç»ƒï¼Œåœ¨éªŒè¯é›†ä¸Šæµ‹è¯•ã€‚

#### 16ï¼š38, 8/1

ä¸‹è½½coco-2014æ•°æ®é›†äº†ï¼Œç”¨è¿…é›·åœ¨è¿™ä¸ªé•œåƒç«™ä¸‹è½½ï¼Œå¬è¯´æ¯”å®˜ç½‘å¿«å¾ˆå¤š

https://pjreddie.com/projects/coco-mirror/

ä½†æ˜¯æœ‰ä¸€ä¸ªç–‘æƒ‘ï¼Œcocoæ•°æ®é›†æ˜¯ç›®æ ‡æ£€æµ‹çš„ï¼Œè¦æ€ä¹ˆæ”¹æˆmulti-labelsçš„

ä½œè€…å¥½åƒæŠŠè¿™ä¸€æ­¥çš„å¤„ç†ç›´æ¥å†™é“datasets/cocodataset.pyé‡Œäº†
```python
class CoCoDataset(data.Dataset):
    def __init__(self, image_dir, anno_path, input_transform=None, labels_path=None):

        ...
      
      self.labels = []
      if self.labels_path:
	      self.labels = np.load(self.labels_path).astype(np.float64)
         self.labels = (self.labels > 0).astype(np.float64)
 	   else:
         l = len(self.coco)
         for i in range(l):
            item = self.coco[i]
            print(i)
            categories = self.getCategoryList(item[1])
            label = self.getLabelVector(categories)               
            self.labels.append(label)


```
è¦ä¸ç„¶å…ˆç”¨ä¸€ä¸ªé˜‰å‰²ç‰ˆçš„cocoè·‘èµ·æ¥å…ˆå§ã€‚ã€‚ã€‚æ•´ä¸ª19Gè‚¯å®šæ˜¯è·‘ä¸èµ·æ¥äº†


#### 17ï¼š22, 8/1

è°·æ­Œäº†ä¸€ä¸‹multi-label classificationç›¸å…³ï¼Œå‘ç°è…¾è®¯åœ¨18å¹´çš„æ—¶å€™ä¹Ÿæäº†ä¸ªå¤šæ ‡ç­¾æ£€æµ‹çš„baselineã€‚ã€‚ã€‚

pytorchä¸Šçš„ä¸€ä¸ªè®¨è®ºï¼Œçœ‹èµ·æ¥ä¸é”™å™¢ï¼š

https://discuss.pytorch.org/t/transfer-learning-for-multi-label-classification-from-a-single-label-model/16755

æ„Ÿè§‰éš¾ç‚¹ä¼šå‡ºç°åœ¨æœ€åmAPçš„è®¡ç®—è§„åˆ™éƒ¨åˆ†ï¼Ÿè™½ç„¶è¯´å¯ä»¥çœ‹ä¸€ä¸‹è®ºæ–‡ä»£ç æ˜¯æ€ä¹ˆç®—çš„

#### 23ï¼š10ï¼Œ8/4
æˆ‘å…ˆè¯•ç€æŠŠè®ºæ–‡ä»£ç çš„æ•°æ®é›†è¯»å–å’Œå¤„ç†çš„ä»£ç æ¡†æ¶ç§»æ¤è¿‡æ¥

ç›®å‰å·²æœ‰çš„ç¯å¢ƒï¼š
| Env | Libs |
|-----|------|
|base|tf-gpu-1.13|
|TEST|torch-1.1.0|
|grad_cam|torch-1.5.0+cu101|
|tf2|tf-2.0.0|
|workspace|N/A|
|workspace37|tf-gpu-2.4.1|

ç»è¿‡æµ‹è¯•ï¼Œgrad_camç¯å¢ƒæ˜¯æ¯”è¾ƒé€‚åˆçš„

#### 0ï¼š22ï¼Œ8/4

åˆšåˆšè§£å†³äº†è°ƒç”¨è®ºæ–‡ä»£ç é‡Œcocodataset.pyæ—¶å‡ºç°çš„ä¸€ä¸ªå°bugã€‚
æœ¬æ¥æ˜¯æƒ³ç›´æ¥è°ƒç”¨cocodataseté‡Œçš„CoCoDatasetç±»ï¼Œä½†æ˜¯é¦–å…ˆå‘ç°è®ºæ–‡ä»£ç é‡Œå¹¶æ²¡æœ‰æä¾›ç¼ºå°‘çš„category.jsonæ–‡ä»¶ï¼Œcocoæ•°æ®é›†é‡Œä¹Ÿæ²¡æœ‰ã€‚çŒœæƒ³åº”è¯¥æ˜¯ç±»åˆ«ååˆ°idçš„ä¸€ä¸ªæ˜ å°„ï¼Œäºæ˜¯ç”¨äº†å®˜æ–¹ç»™çš„ä¸€ä¸ªå°è„šæœ¬æ‰“å°å‡ºäº†categoryå’Œå¯¹åº”çš„idï¼š

https://tech.amikelive.com/node-718/what-object-categories-labels-are-in-coco-dataset/

è¿™æ ·å°±æœ‰äº†categoryçš„jsonæ–‡ä»¶äº†ã€‚ä½†æ˜¯åæ¥å‘ç°è¿˜æ˜¯æŠ¥é”™ï¼š
```python
   label = self.getLabelVector(categories)

  File "L:\sysuTask\ResNet-101-BM\cocodataset.py", line 56, in getLabelVector
    print("debug:",self.category_map[str(c)])

TypeError: list indices must be integers or slices, not str
```
ç„¶è€Œprintå‡ºæ¥çš„cæ˜¯æ•´æ•°ã€‚ã€‚ã€‚å¤§èƒ†çŒœæµ‹ï¼Œè®ºæ–‡ä½œè€…çš„æ•°æ®é›†çš„cåº”è¯¥æ˜¯ç±»åˆ«åï¼Œå› æ­¤éœ€è¦ä¸€ä¸ªcategory.jsonæ˜ å°„åˆ°idï¼Œç„¶è€Œæˆ‘çš„æ•°æ®é›†çš„cå·²ç»æ˜¯idäº†ï¼Œé‚£å°±ä¸éœ€å¤šæ­¤ä¸€ä¸¾ï¼Œ
```python
        for c in categories:
            index = c-1
            label[index] = 1.0 / label_num
        return label
```
æ”¹æˆè¿™æ ·å°±okäº†ï¼Œç¡è§‰ã€‚

#### 16:05, 8/4
æ‰“ç®—å…ˆç”¨40504ä¸ªæ ·æœ¬ï¼Œå…ˆç”Ÿæˆlistä¹‹åä¿å­˜ï¼Œä»¥å¤‡ä¸‹æ¬¡å†ç”¨ã€‚

```python
cuda:0 -> GeForce GTX 1050 is available.
loading annotations into memory...
Done (t=7.29s)
creating index...
index created!
  2%|â–         | 890/40504 [02:59<1:16:36,  8.62it/s]
```
python listçš„ä¿å­˜å’Œè¯»å–ï¼š

https://blog.csdn.net/weixin_42769131/article/details/104242416?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.control&spm=1001.2101.3001.4242

æ•°æ®æµï¼š

``class CoCoDataset(in cocodataset.py) -> train_set(in transforms.py) -> train_loader(in transforms.py) -> get_train_test_set(in main.py)``

#### 9ï¼š10ï¼Œ8/5
*args å’Œ **kwargsçš„ç”¨æ³•

https://www.jianshu.com/p/0ed914608a2c

çœ‹äº†ä¸€ä¸‹è…¾è®¯AIlabçš„resnetï¼Œæœ€åä¸€å±‚ï¼š
```python
self.logit = self._fully_connected(x, out_dim=self.num_classes)
```
é‚£ä¹ˆæˆ‘å°±ç›´æ¥æŠŠæœ€åä¸€ä¸ªfcæ”¹æˆ
``self.fc = nn.Linear(2048, num_classes)``å°±å¥½äº†

BCEWithLogitsLossæ˜¯ç”¨æ¥è®¡ç®—å¤šæ ‡ç­¾åˆ†ç±»çš„è¯¯å·®çš„ï¼š

https://blog.csdn.net/qq_22210253/article/details/85222093

æ‰“ç®—ä½¿ç”¨é¢„è®­ç»ƒ+cocoä¸Šfinetuneï¼ŒpytorchåŠ è½½ä¸è®­ç»ƒæ¨¡å‹ï¼š
```python
state_dict = torch.load('trained.pth')
model.load_state_dict(state_dict)
```
è¿™æ ·å¯èƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºæ€»ä¼šæœ‰å‡ ä¸ªkeyå¯¹åº”ä¸ä¸Šï¼Œè¦ç”¨strich=Falseæ¯”è¾ƒå¥½ï¼š
```python
model.load_state_dict(state_dict, strict=False)
```
ä»¥ä¸Šå‚è€ƒï¼š
https://blog.csdn.net/t20134297/article/details/110533007

#### 8ï¼š37 8/6
æ˜¨æ™šæŒ‚äº†ä¸€æ™šç«Ÿç„¶æ²¡æˆåŠŸä¿å­˜ä¸‹æ¥ï¼Œæ°”æ­»
ä»Šå¤©åˆè¦èŠ±ä¸€ä¸ªæ—©ä¸Šç”Ÿæˆlistäº†
``3%|â–         | 2881/82783 [02:40<7:58:02,  2.79it/s]``

åŠå°æ—¶ç™½ç»™ã€‚ã€‚ã€‚
```python
OSError: image file is truncated (9 bytes not processed)
 29%|â–ˆâ–ˆâ–‰       | 23807/82783 [37:31<2:02:18,  8.04it/s]
```
å‘ç°é—®é¢˜äº†ï¼Œç¬¬23086å¼ ç…§ç‰‡æœ‰é—®é¢˜ã€‚
è¦åŠ ä¸€å¥``Image.LOAD_TRUNCATED_IMAGES = True``
https://blog.csdn.net/hzs3237259/article/details/108188323

ä½†æ˜¯æ”¹å®Œcoco.pyä¸­çš„ä»£ç ååˆæŠ¥é”™äº†ï¼ŒæŠ¥é”™å¦‚ä¸‹
```python
TypeError: super(type, obj): obj must be an instance or subtype of type
```
çŒœæµ‹æ˜¯coco.pyä½œä¸ºä¸€ä¸ªè¢«è°ƒç”¨è„šæœ¬åœ¨è¿è¡Œä¸€æ¬¡åå¦‚æœä¿®æ”¹å®ƒçš„å†…å®¹ï¼Œå†è°ƒç”¨æ—¶å†…æ ¸å‘ç°ä¸¤è€…ä¸ä¸€è‡´è€ŒæŠ¥çš„é”™ï¼Œå› æ­¤æ¯æ¬¡æ”¹å®Œcoco.pyä¹‹åéƒ½éœ€è¦restart kernel(å¥½éº»çƒ¦)

åŠ äº†``Image.LOAD_TRUNCATED_IMAGES = True``è¿˜æ˜¯ä¸è¡Œå•Šã€‚ã€‚ã€‚
å•Šè¿™ã€‚ã€‚ã€‚ã€‚çœ‹äº†ä¸‹ï¼Œæˆ‘æœ¬æ¥ä»¥ä¸ºcoco.pyåªè°ƒç”¨äº†Imageæ‰€ä»¥å°±æ“…ä½œä¸»å¼ æŠŠ``ImageFile.LOAD_TRUNCATED_IMAGES = True``æ”¹æˆäº†``Image.LOAD_TRUNCATED_IMAGES = True``
ä½†æ˜¯å®é™…ä¸Šè¿™æ ·æ”¹æ²¡æœ‰ç”¨(ä¹Ÿä¸çŸ¥é“ä¸ºå•¥æ²¡æŠ¥é”™)ï¼Œå¦‚æœæ²¡ç”¨åˆ°ImageFileå°±éœ€è¦import imagefileï¼Œæ‰€ä»¥æ­£ç¡®çš„åšæ³•åº”è¯¥æ˜¯åœ¨coco.pyä¸­å®Œæ•´åœ°åŠ å…¥ä¸‹é¢ä¸¤è¡Œä»£ç ï¼š
```python
from PIL import ImageFile
ImageFile.LOAD_TRUNCATED_IMAGES = True
```
æµªè´¹åŠä¸ªå°æ—¶ã€‚ã€‚ã€‚ä¸è¿‡ä¹Ÿæ²¡åŠæ³•ï¼Œè¿™ç§é”™è¯¯ç¢°åˆ°ä¸‹æ¬¡å°±çŸ¥é“äº†

#### 16ï¼š37 8/6

å‡ºäº†é—®é¢˜
```python
  File "D:\Anaconda\envs\grad_cam\lib\multiprocessing\reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)

BrokenPipeError: [Errno 32] Broken pipe
```
å¥½åƒæ˜¯å› ä¸ºå¤šçº¿ç¨‹çš„åŸå› ?
çœ‹äº†ä¸€ä¸‹æºç ï¼Œæ‰¾åˆ°äº†ã€‚è·Ÿè¸ªæŠ¥é”™åˆ° dataloader .py ,æœ‰ï¼š
```python
    def __iter__(self):
        if self.num_workers == 0:
            return _SingleProcessDataLoaderIter(self)
        else:
            return _MultiProcessingDataLoaderIter(self)
```
æ‰€ä»¥åº”è¯¥è¦æŠŠworkeræ•°è®¾ç½®æˆ0

```python
  File "L:\sysuTask\ResNet-101-BM\resnet.py", line 157, in forward
    x = self.fc(x)
  File "D:\Anaconda\envs\grad_cam\lib\site-packages\torch\nn\modules\module.py", line 550, in __call__
    result = self.forward(*input, **kwargs)
  File "D:\Anaconda\envs\grad_cam\lib\site-packages\torch\nn\modules\linear.py", line 87, in forward
    return F.linear(input, self.weight, self.bias)
  File "D:\Anaconda\envs\grad_cam\lib\site-packages\torch\nn\functional.py", line 1612, in linear
    output = input.matmul(weight.t())
RuntimeError: size mismatch, m1: [73728 x 9], m2: [2048 x 90]
```
è¿™ä¸ªæŠ¥é”™åº”è¯¥å’Œæˆ‘æ”¹resneté‡Œçš„æœ€åä¸€å±‚fcæœ‰å…³ã€‚æˆ‘è®¾å®šçš„fcæ˜¯2048x90(class_num)ï¼Œä½†æ˜¯ä»–è¿™ä¸ªmismatchåˆ°åº•æ˜¯å•¥æ„æ€ï¼Œ
è®ºæ–‡é‡Œé¢ä¸ä¹Ÿæ˜¯è¯´2048 to cã€‚ã€‚ã€‚å…ˆæŠŠ2048æ”¹æˆ73728çœ‹çœ‹ä¼šä¸ä¼šæŠ¥é”™ï¼Œæˆ–è€…æˆ‘åœ¨æƒ³è¦ä¸è¦73728-2048-cè¿™æ ·åŠ ä¸¤å±‚,
è¿™æ ·éšå«å±‚åº”è¯¥å°±æ˜¯2048ä¸ªèŠ‚ç‚¹äº†å§
```python
RuntimeError: size mismatch, m1: [73728 x 9], m2: [73728 x 90] 
```
ä½†æ˜¯è¿™æ ·è¿˜æ˜¯ä¸è¡Œï¼Œéš¾é“è¦å®Œå…¨ä¸€æ ·å—ã€‚ã€‚ã€‚
æ‡‚äº†ã€‚ã€‚ã€‚pytorchçš„è§„åˆ™æ˜¯[a,b],[b,c]è¿™æ ·ï¼Œä½†æ˜¯ä¸Šä¸€å±‚æ€ä¹ˆç›´æ¥å°±åˆ°9äº†å•Šã€‚ã€‚ã€‚

è®°å½•ä¸€ä¸‹
```python
        x = self.layer1(x)
        x = self.layer2(x)
        x = self.layer3(x)
        x = self.layer4(x) [4, 2048, 18, 18]
        x = self.avgpool1(x) [4, 2048, 9, 9]
        x = x.view(x.size(0), -1) [4, 591872]
        x = self.fc(x) 
        
        				è¿™ç§æƒ…å†µä¸‹æŠ¥é”™ï¼š[147456 x 18] mismatch [2048 x 90]
        				å¯¹æ¯”ä¸€ä¸‹åº”è¯¥æ˜¯ 4x2048x18 = 147456, æ‰€ä»¥è¦æä¸€ä¸ªç±»ä¼¼äº
        				reshapeçš„ä¸œè¥¿ï¼Œç»™ä»–å®šå‹ä¸€ä¸‹
        				é¡ºä¾¿ä¹Ÿè§£é‡Šäº†ä¸ºä»€ä¹ˆavgpoolä¼šå‡ºç°73728*9ï¼š
        				4 x 2048 x 18 x 18 -> 
        				147456 x 18 -> 
        				2654208 ->
        				avgpoolçš„stride=2,æ‰€ä»¥è¦é™¤ä»¥4,å°±æœ‰
        				2654208/4=663552 -> 73728 x 9 
```     			
æœ€åè¿˜æ˜¯ç›´æ¥æ‰‹åŠ¨è®¾è®¡åé¢çš„å‡ å±‚ï¼Œå› ä¸ºä¸€å±‚çš„avgpoolingå‡ºæ¥çš„ç‰¹å¾æ„Ÿè§‰å¤ªå¤šäº†ï¼Œæ€•ç›´æ¥å…¨è¿æ¥ç”µè„‘åƒä¸æ¶ˆï¼Œäºæ˜¯ç”¨äº†ä¸¤å±‚çš„poolingï¼Œç„¶åç›´æ¥(å¦‚æœåé¢æ•ˆæœä¸å¥½è¿™æ˜¯ä¸€ä¸ªå¯ä»¥è€ƒè™‘æ”¹è¿›çš„åœ°æ–¹)ï¼š
```python
        å®šä¹‰ï¼š
        self.avgpool1 = nn.AvgPool2d(3, stride=2)
        self.avgpool2 = nn.AvgPool2d(2, stride=1)
        #self.fc = nn.Linear(8192, num_classes)
        #self.fc = nn.Linear(512 * block.expansion, num_classes)
        self.fc = nn.Linear(100352, num_classes) #[100532 = 2048*7*7]

        forwardï¼š
        x = self.layer4(x)
        x = self.avgpool1(x)
        x = self.avgpool2(x) #[4, 2048, 7, 7]
        #print(x.shape)
        x = x.view(x.size(0), -1)
        #print(x.shape)
        x = self.fc(x)
        #print(x.shape)
        #assert False
```   

è·‘èµ·æ¥äº†ï¼ï¼ï¼
```python
Epoch: [0][0/20696]     Time 67.750 (67.750)    Loss 0.6822 (0.6822)
Epoch: [0][5/20696]     Time 1.461 (12.713)     Loss 0.6441 (0.6754)
Epoch: [0][10/20696]    Time 1.113 (7.569)      Loss 0.6201 (0.6552)
Epoch: [0][15/20696]    Time 1.153 (5.588)      Loss 0.5714 (0.6338)
Epoch: [0][20/20696]    Time 1.378 (4.573)      Loss 0.5413 (0.6116)
```
ç°åœ¨23ï¼š39ï¼Œåˆšåˆšctrl+cå¤åˆ¶ä¸€ä¸‹logç»“æœkeyboard interruptäº†ã€‚ã€‚ã€‚åæ­£ä»Šæ™šä¹Ÿè·‘ä¸å®Œï¼Œè‡³å°‘æ˜¯èƒ½è·‘èµ·æ¥çš„ã€‚æ˜å¤©è·‘å®Œçœ‹ä¸€ä¸‹mAPå§(æ€»æ„Ÿè§‰æ²¡è¿™ä¹ˆç®€å•)


#### 9:00 8/9
ç§»æ¤äº†ä¸€ä¸ªjupyternotebookè„šæœ¬ï¼Œæ–¹ä¾¿colabä¸Šè·‘ï¼š
https://github.com/satoshiSchubert/WorkSpace/blob/main/sysuTask.ipynb

å¾ˆçƒ¦ï¼Œcolabä¸Šgpuæœ‰ä½¿ç”¨é™é¢ï¼Œtpuåˆè¦æ›´æ”¹ä»£ç 
ç°åœ¨åœ¨å‚ç…§å®˜æ–¹çš„pytorch tpu colabä¾‹ç¨‹ä¿®æ”¹ä»£ç ï¼š
https://colab.research.google.com/github/pytorch/xla/blob/master/contrib/colab/resnet18-training.ipynb#scrollTo=8vMl96KLoCq8

è¿˜æ˜¯å¤±è´¥äº†ï¼ŒæŠ¥äº†ä¸€ä¸ªå¾ˆåº•å±‚çš„æ•°ç»„è¶Šç•Œé”™è¯¯ï¼Œå¾ˆéš¾debug
ç°åœ¨åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„è°·æ­Œè´¦å·æ¥è¹­å®ƒçš„gpu

Colabä¸Šè¹­çš„TeslaT4ï¼Œä¸€ä¸ªiteræŒ‰0.25sç®—ï¼Œé¢„è®¡1.5hå¯ä»¥è·‘å®Œ

#### 13ï¼š37 8/9
ä¸€ä¸ªåŠå°æ—¶å¥½ä¸å®¹æ˜“è®­ç»ƒå®Œä¸€ä¸ªepochï¼Œç»“æœvalidate()é‡Œé¢çš„tensor.item()å¿˜è®°æ”¹ï¼Œç™½æ

#### 18ï¼š22 8/9
ç›®å‰æ˜¯è·‘å®Œä¸¤ä¸ªEpochäº†ï¼Œæˆ‘çœ‹losså€¼åŸºæœ¬ä¸Šä¸‹é™å¾—æ¯”è¾ƒæ…¢äº†(ä¹Ÿæœ‰å¯èƒ½è·‘æ»¡200ä¸ªEpochè¿˜èƒ½æœ‰å¾ˆå¯è§‚çš„æå‡ï¼Œä½†æ˜¯è¿˜æ˜¯å¾—çœ‹mAPçš„å€¼æ‰èƒ½è¯æ˜)
å¾ˆå¥‡æ€ªçš„æ˜¯ï¼Œä¸çŸ¥é“æ˜¯æˆ‘ä»£ç æ²¡æ”¹å¥½è¿˜æ˜¯å…¶ä»–åŸå› ï¼Œcolabæ²¡æ³•æŠŠmAPå€¼æ‰“å°å‡ºæ¥ï¼š
```python
Test: [10125/10126]	Time 0.215 (0.213)	Loss 0.0822 (0.1077)
(40504, 180)
 * mAP nan
```
ä¸è¿‡ä¸‡å¹¸çš„æ˜¯ä¸¤ä¸ªEpochè·‘å‡ºæ¥çš„checkpointå’Œscoreéƒ½ä¿å­˜ä¸‹æ¥äº†ï¼Œå¹¶ä¸”scoreé‡Œå­˜å‚¨äº†é¢„æµ‹å€¼å’Œæ ‡ç­¾ï¼Œåº”è¯¥æ˜¯å¯ä»¥æ‹¿æ¥ç›´æ¥è®¡ç®—çš„ï¼Œä½†æ˜¯å°±æ˜¯å¾—é¢å¤–å†å†™ä¸ªè„šæœ¬äº†ã€‚

#### ç¬¬ä¸€æ¬¡è®­ç»ƒç»“è®º(Epoch = 2)ï¼š

ç”¨excelçœ‹äº†ä¸€ä¸‹ç”Ÿæˆçš„ç»“æœscoreæ–‡ä»¶ï¼Œç½‘ç»œç€é‡åœ¨åˆ†ç±»personç±»äº†ï¼Œå…¶ä»–ç±»çš„è¾“å‡ºçš„å‡ ä¹å…¨éƒ½æ˜¯è´Ÿå€¼ï¼Œå‡†ç¡®åº¦å·®å¾ˆå¤šã€‚ã€‚çŒœæµ‹åº”è¯¥æ˜¯personå‡ºç°çš„é¢‘ç‡æœ€é«˜ä¸”å¤§å¤§é«˜äºå…¶ä»–ç±»ï¼Œæ‰€ä»¥ç½‘ç»œç»™personæ­£å€¼æ—¶å¯ä»¥ä½¿å…¶lossè¾ƒå°ã€‚çœ‹æ¥å¾ˆå¯èƒ½æ˜¯å› ä¸ºè®­ç»ƒçš„Epochä¸å¤Ÿï¼Œæ¯•ç«Ÿæ‰2è½®ï¼Œè™½ç„¶ä¸€è½®å°±è¦ä¸€ä¸ªåŠå°æ—¶ã€‚å¤šè®­ç»ƒå‡ è½®ç›¸ä¿¡ä¼šæ”¹å–„ã€‚

è®¡ç®—mAPçš„æ—¶å€™æŠ¥é”™ï¼š
```python
RuntimeWarning: invalid value encountered in true_divide
```
è¿™ä¸ªé—®é¢˜åº”è¯¥æ˜¯åœ¨0/0çš„æ—¶å€™é€ æˆçš„
é€šè¿‡åœ¨åˆ†å­åˆ†æ¯åŒæ—¶åŠ ä¸Š1e-10,å®Œç¾è§£å†³ã€‚

ä½†æ˜¯ç¬¬ä¸€è½®ç®—å‡ºæ¥çš„mAPåªæœ‰0.1016077459353008ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚å¤ªä½äº†å§

#### 10:00 8/15

æ ¹æ®å­¦é•¿çš„å»ºè®®ï¼ŒæŠŠåŸæ¥çš„resnetç›´æ¥æ”¹æˆåŸæ±åŸå‘³çš„resnetï¼š
```python
    model = torchvision.models.resnet101(pretrained=True)
    model.fc = nn.Sequential(
    nn.Dropout(0.5),
    nn.Linear(2048, num_classes)
    )
```
transforméƒ¨åˆ†ä¹Ÿä¿®æ”¹äº†ï¼Œæ”¹æˆresnetæ‰€å¯¹åº”çš„é¢„å¤„ç†æ–¹æ³•

ä¿®æ”¹ä¹‹åæ¯ä¸€ä¾‹éœ€è¦çš„è®­ç»ƒæ—¶é—´æ˜¯0.073s,æ¯”åŸæ¥çš„0.25så¿«äº†å¤§çº¦4å€ï¼Œå¾ˆå¥½ï¼
æˆ‘æƒ³åº”è¯¥ä¹Ÿæ˜¯å›¾ç‰‡é¢„å¤„ç†éƒ¨åˆ†å˜å¾—æ›´ç®€å•äº†ï¼Œå› æ­¤å¿«äº†å¾ˆå¤š

æŠŠEpochè®¾å®šåˆ°20åº”è¯¥é—®é¢˜ä¸å¤§ï¼Œè®­ç»ƒæ—¶é—´ä¹Ÿæ˜¯å¯æ¥å—çš„



